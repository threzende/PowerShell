Get-Disk | ForEach-Object {
    $disk = $_
    Get-Partition -DiskNumber $disk.Number | ForEach-Object {
        $partition = $_
        Get-Volume -DriveLetter $partition.DriveLetter | Select-Object @{
            Name="DiskNumber";Expression={$disk.Number}},
            @{Name="FriendlyName";Expression={$disk.FriendlyName}},
            @{Name="PartitionNumber";Expression={$partition.PartitionNumber}},
            DriveLetter, FileSystemLabel, Size, SizeRemaining,
            @{Name="SerialNumber";Expression={
                (Get-PhysicalDisk | Where-Object DeviceID -eq $disk.Number).SerialNumber
            }}
    }
}
