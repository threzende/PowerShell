Get-ChildItem "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall",
              "HKLM:\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall" |
    Get-ItemProperty |
    Where-Object { $_.DisplayName -like "*SolarWinds*" } |
    Sort-Object {[version]($_.DisplayVersion)} -Ascending |
    ForEach-Object {
        "$($_.DisplayVersion) - $($_.PSChildName)"
    }















2 ##########################################################################################

$TargetVersionPrefix = "2025"

$uninstallPaths = @(
    "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall",
    "HKLM:\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall"
)

$resultados = foreach ($path in $uninstallPaths) {
    if (Test-Path $path) {
        Get-ChildItem $path | ForEach-Object {
            $item = Get-ItemProperty $_.PsPath

            if ($item.DisplayName -like "*SolarWinds*" -and
                $null -ne $item.DisplayVersion -and
                $item.DisplayVersion -notlike "$TargetVersionPrefix*") {

                [PSCustomObject]@{
                    Name            = $item.DisplayName
                    Version         = $item.DisplayVersion
                    ProductId       = $_.PSChildName
                    UninstallString = $item.UninstallString
                    RegistryPath    = $_.PsPath
                }
            }
        }
    }
}

if ($resultados) {
    Write-Host ""
    Write-Host ("Found SolarWinds installations different from version {0}:" -f $TargetVersionPrefix)
    Write-Host ""
    $resultados | Sort-Object Name, Version | Format-Table -AutoSize
} else {
    Write-Host ""
    Write-Host ("Only SolarWinds {0} found (or no SolarWinds installed)." -f $TargetVersionPrefix)
    Write-Host ""
}

