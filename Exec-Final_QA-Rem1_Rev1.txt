### Script para listar discos, labels e programas instalados e salvar em HTML ###

# Defina o caminho do arquivo HTML
$outputFile = "C:\\Temp\\DiskInfo.html"

# Colete informações sobre os volumes
$volumes = Get-Volume | Select-Object DriveLetter, FileSystemLabel, Size

# Colete informações sobre os programas instalados
$programs = @(
    "Carbon Black",
    "Nessus",
    "SolarWinds",
    "Trellix Endpoint"
)

$installedPrograms = Get-WmiObject -Class Win32_Product | Where-Object {
    $programs -contains $_.Name
} | Select-Object Name, Version, InstallDate

# Início do HTML
$html = @"
<!DOCTYPE html>
<html>
<head>
    <title>Disk and Program Information</title>
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
        }
        th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <h1>Disk and Volume Information</h1>
    <table>
        <thead>
            <tr>
                <th>Drive Letter</th>
                <th>Label</th>
                <th>Total Size (GB)</th>
            </tr>
        </thead>
        <tbody>
"@

# Adicione informações sobre cada volume ao HTML
foreach ($volume in $volumes) {
    $totalSizeGB = [math]::Round($volume.Size / 1GB, 2)
    $html += "<tr>
                <td>$($volume.DriveLetter)</td>
                <td>$($volume.FileSystemLabel)</td>
                <td>$totalSizeGB</td>
              </tr>"
}

$html += @"
        </tbody>
    </table>
    <h1>Installed Programs</h1>
    <table>
        <thead>
            <tr>
                <th>Program Name</th>
                <th>Version</th>
                <th>Install Date</th>
            </tr>
        </thead>
        <tbody>
"@

# Adicione informações sobre os programas instalados ao HTML
foreach ($program in $installedPrograms) {
    $installDate = if ($program.InstallDate) { [DateTime]::ParseExact($program.InstallDate, "yyyyMMdd", $null).ToShortDateString() } else { "N/A" }
    $html += "<tr>
                <td>$($program.Name)</td>
                <td>$($program.Version)</td>
                <td>$installDate</td>
              </tr>"
}

# Finalize o HTML
$html += @"
        </tbody>
    </table>
</body>
</html>
"@

# Salve o HTML no arquivo
Set-Content -Path $outputFile -Value $html

Write-Host "HTML file generated at $outputFile"
