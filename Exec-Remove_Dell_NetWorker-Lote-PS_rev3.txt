$serverList = Get-Content -Path "C:\temp\thsfz"
$logFilePath = "C:\temp\dellNWlogz.txt"

foreach ($server in $serverList) {
    try {
        $session = New-PSSession -ComputerName $server
        Invoke-Command -Session $session -ScriptBlock {
            $app = Get-WmiObject -Class Win32_Product | Where-Object { $_.Name -eq "Dell NetWorker" }
            $app.Uninstall()
        }
        Remove-PSSession -Session $session
        
        $status = "Sucesso: Desinstalação do Dell NetWorker concluída no servidor $server."
        Write-Output $status
        Add-Content -Path $logFilePath -Value $status
    } catch {
        $status = "Erro: Falha ao desinstalar o Dell NetWorker no servidor $server. Detalhes do erro: $_"
        Write-Output $status
        Add-Content -Path $logFilePath -Value $status
    }
}
