# Configura a política de execução para permitir a execução de scripts
Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope Process -Force

# Lista de servidores
$servers = @("server01", "server02", "server03")

# Função para obter o tempo de atividade do sistema
function Get-SystemUptime {
    param (
        [string]$server
    )

    try {
        # Tenta obter o tempo de inicialização do sistema
        $bootTime = Get-CimInstance -ComputerName $server -ClassName win32_operatingsystem | Select-Object -ExpandProperty LastBootUpTime

        # Calcula o tempo de atividade
        $uptime = (Get-Date) - $bootTime

        # Exibe o tempo de atividade formatado
        Write-Output "System Uptime for $server: $($uptime.Days) days, $($uptime.Hours) hours, $($uptime.Minutes) minutes"
    } catch {
        Write-Output "Failed to retrieve uptime for $server. Error: $($_.Exception.Message)"
    }
}

# Loop através da lista de servidores
foreach ($server in $servers) {
    Get-SystemUptime -server $server
}
