# Configura a política de execução para permitir a execução de scripts
Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope Process -Force

# Nome do servidor remoto
$server = "NomeDoServidor"  # Substitua "NomeDoServidor" pelo nome ou IP do servidor na sua rede

# Função para obter o tempo de atividade do sistema remoto
function Get-RemoteSystemUptime {
    param (
        [string]$server
    )

    try {
        # Executa o comando remotamente usando Invoke-Command
        $bootTime = Invoke-Command -ComputerName $server -ScriptBlock {
            (Get-CimInstance -ClassName win32_operatingsystem).LastBootUpTime
        }

        # Calcula o tempo de atividade
        $uptime = (Get-Date) - $bootTime

        # Exibe o tempo de atividade formatado
        Write-Output ("System Uptime for {0}: {1} days, {2} hours, {3} minutes" -f $server, $uptime.Days, $uptime.Hours, $uptime.Minutes)
    } catch {
        Write-Output ("Failed to retrieve uptime for {0}. Error: {1}" -f $server, $_.Exception.Message)
    }
}

# Executa a função para obter o uptime do servidor remoto
Get-RemoteSystemUptime -server $server
