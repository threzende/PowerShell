# Configura a política de execução para permitir a execução de scripts
Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope Process -Force

# Lista de servidores
$servers = @("server01", "server02", "server03")

# Função para obter o tempo de inicialização do sistema
function Get-SystemBootTime {
    param (
        [string]$server
    )

    try {
        # Tenta estabelecer uma sessão CIM no servidor remoto
        $sessionOptions = New-CimSessionOption -UseSsl -SkipCACheck -SkipCNCheck -SkipRevocationCheck
        $session = New-CimSession -ComputerName $server -SessionOption $sessionOptions

        # Obtém a instância CIM para o Win32_OperatingSystem
        $bootTime = Get-CimInstance -CimSession $session -ClassName win32_operatingsystem | Select-Object -ExpandProperty LastBootUpTime

        # Exibe o tempo de inicialização formatado
        Write-Output ("System Boot Time for {0}: {1}" -f $server, $bootTime.ToString('MM/dd/yyyy, hh:mm:ss tt'))

        # Remove a sessão CIM
        Remove-CimSession -CimSession $session
    } catch {
        Write-Output ("Failed to retrieve boot time for {0}: {1}" -f $server, $_)
    }
}

# Loop através da lista de servidores
foreach ($server in $servers) {
    Get-SystemBootTime -server $server
}
